package h3xadecimal.liteantiexploit;

import h3xadecimal.liteantiexploit.module.ModuleManager;
import org.bukkit.configuration.ConfigurationSection;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;

import java.io.File;
import java.util.logging.Logger;

public class Core {
    private static final boolean debug = false;

    public static Core create(LiteAntiExploit plugin) {
        Core c = new Core(plugin);
        c.start();
        return c;
    }

    public static void end(Core inst) {
        inst.stop();
    }

    private final LiteAntiExploit plugin;
    private final ModuleManager moduleManager = new ModuleManager(this);

    private final FileConfiguration fc;
    private FileConfiguration modulesConfig;

    private Core(LiteAntiExploit plugin) {
        this.plugin = plugin;
        fc = plugin.getConfig();
    }

    private void start() {
        plugin.saveResource("modules.yml", false);
        modulesConfig = YamlConfiguration.loadConfiguration(new File(plugin.getDataFolder(), "modules.yml"));
        moduleManager.init();
    }

    private void stop() {
        moduleManager.exit();
    }

    public Logger getLogger() {
        return plugin.getLogger();
    }

    public void sendDebug(String msg) {
        if (debug) getLogger().info("[DEBUG] " + msg);
    }

    public ConfigurationSection getPacketConfig() {
        return modulesConfig.getConfigurationSection("packet");
    }
}
